#!/bin/bash

INIFILES_BASE_DIR="sources/inifiles"

usage() {
    echo
    echo 'Usage: 'run_experiments' <exp_type> <exp_ID> <first_experiment> [last_experiment]'
    echo
    echo '    exp_type:'
    echo '        ''ish'' | ''inverse-saturated-heights'' - inverse problem for'
    echo '             fully saturated media with measured water heights'
    echo '    exp_ID: experiment_ID - a unique identifier of experiment series'
    echo
    echo '    first_experiment: number of first experiment in exp_ID series of'
    echo '             experiments'
    echo '    last_experiment: if specified, computes all experiments between'
    echo '             the first_experiment and last_experiment (included);'
    echo '             if not specified, computes only first_experiment'
    echo 

    exit 0
}

if [ -z "$1" ]; then
    usage
fi

case "$1" in
    'ish' | 'inverse-saturated-heights')
	EXP_TYPE='inverse-saturated-heights'


	;;
    *)
	echo 'Unknown experiment type: '$1
	usage

	exit 0
esac

EXP_ID="$2"

first_experiment=$3
if [ -z "$4" ]; then
    last_experiment=$first_experiment
else
    last_experiment=$4
fi

run_experiments() {
    echo
    echo ---------------------------------------------------------
    echo GENERAL experiments informations
    echo
    echo First experiment: $first_ini_number
    echo Last experiment:  $last_ini_number

    ini_dir="${INIFILES_BASE_DIR}/${EXP_TYPE}/${EXP_ID}"


    for (( i=${first_experiment}; i<=${last_experiment}; i++ ))
    do
	echo
	echo =============================================================
	echo Executing $EXP_TYPE problem.
	echo Experiment ${i}:
	
	filename="${ini_dir}/experiment_${i}.ini"
	python inverse_saturated.py -i "$filename"

	echo
	echo Experiment ${i}: finished.
    done
}

run_experiments